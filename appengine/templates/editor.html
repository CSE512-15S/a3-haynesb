<html>
<head>
<title>Myria Web Frontend</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="css/layout.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="js/codemirror.js"></script>
<link href="css/codemirror.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="js/jquery-1.8.2.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/editor.js"></script>
<script type="text/javascript" src="js/viz.js">
	// This is from mdaines on github: http://mdaines.github.io/viz.js/viz.js
</script>

</head>
<body>
	<nav class="navbar navbar-inverse" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse"
				data-target=".navbar-ex1-collapse">
				<span class="sr-only">Toggle navigation</span> <span
					class="icon-bar"></span> <span class="icon-bar"></span> <span
					class="icon-bar"></span>
			</button>
			<a class="navbar-brand">Myria Web Frontend</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse navbar-ex1-collapse">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/editor">Editor</a></li>
				<li><a href="/queries">Queries</a></li>
				<li><a href="/datasets">Datasets</a></li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<li><a>{{connection_string}}</a></li>
			</ul>
		</div>
		<!-- /.navbar-collapse -->
	</nav>

	<div class="content">
		<div class="background region">
			<div class="background menu"></div>
		</div>
		<div class="left_block menu">
			<div class="content">
				<div class="examples">
					<div>
						<em>Examples (click)</em>
					</div>
					<div class="label">Select</div>
					<div class="example">A(x) :- R(x,3)</div>
					<div class="label">Select2</div>
					<div class="example">A(x) :- R(x,y),S(y,z,4),z<3</div>
					<div class="label">Self-join</div>
					<div class="example">A(x,z) :- R(x,y),R(y,z)</div>
					<div class="label">Triangle</div>
					<div class="example">A(x,z) :- R(x,y),S(y,z),T(z,x)</div>
					<div class="label">Cross Product</div>
					<div class="example">A(x,z) :- S(x),T(z)</div>
					<div class="label">Two cycles</div>
					<div class="example">A(x,z) :- R(x,y),S(y,a,z),T(z,b,x),W(a,b)</div>
					<!-- 
					<div class="label">Two Chained Rules</div>
					<div class="example">A(x,z) :- R(x,y,z); B(w) :- A(3,w)</div> -->
					<div class="label">Two Independent Rules</div>
					<div class="example">A(x,z) :- R(x,y,z); B(w) :- C(3,w)</div>
					<br>
					<div class="label">Project TwitterK</div>
					<div class="example">JustX(x) :- TwitterK(x,y)</div>
					<div class="label">Self Join TwitterK</div>
					<div class="example">SelfJoin(x,z) :- TwitterK(x,y), TwitterK(y,z)</div>
					<div class="label">In Degrees from TwitterK</div>
					<div class="example">InDegree(x, COUNT(y)) :- TwitterK(x,y)</div>
					<div class="label">Two Hops Count in TwitterK</div>
					<div class="example">TwoHopsCountK(x,z,COUNT(y)) :- TwitterK(x,y), TwitterK(y,z)</div>
					<!--  <div class="label">Two Hops Distinct Count in TwitterK</div>
					<div class="example">TwoHopsDistinctCountK(x, z, COUNT(y)) :- TwoHopsK(x, y, z)</div> -->
					<!--  <div class="label">Triangles TwitterK</div>
					<div class="example">Triangles(x,y,z) :- TwitterK(x,y), TwitterK(y,z), TwitterK(z,x)</div> -->
					<br>				
					<div class="label">NCCDC Filtered to Attack Window</div>
					<div class="example">attackwindow(src, dst, time) :-
	nccdc(src,dst,proto,time, x, y, z)
    , time > 1366475761
    , time < 1366475821</div>
					<div class="label">NCCDC DDOS Victims</div>
					<div class="example">InDegree(dst, count(time)) :- nccdc(src, dst, proto, time, x, y, z)

Victim(dst) :- InDegree(dst, cnt), cnt > 10000</div>
				</div>
			</div>
		</div>
		<div class="right_block region">
			<div class="content">
				<output id="relational_svg"></output>
				<output id="myria_svg"></output>
			</div>
		</div>
		<div class="center_block region">
			<div class="content">
				<div class="panel panel-info">
					<div class="panel-heading">
						<h3 class="panel-title">
							Write your Datalog here, perhaps starting from one of the
							examples at the left.<br> (Note: Recursion and aggregation
							are still being tested)
						</h3>
					</div>
					<textarea cols="83" rows="2" id="query">{{ query }}</textarea>
					<button type="button" class="planner btn btn-info">Go</button>
				</div>

				<div class="panel panel-warning">
					<div class="panel-heading">
						<h3 class="panel-title">Datalog parsed as Relational Algebra</h3>
					</div>
					<div class="panel-body">
						<div id="plan"></div>
					</div>
					<div class="panel-heading"><h3 class="panel-title">Relational algebra converted and
						optimized into a Myria Physical Plan</h3></div>
					<div class="panel-body">
						<div id="optimized"></div>
					</div>
					<button type="button" class="compiler btn btn-warning">Myria
						JSON</button>
				</div>

				<div class="panel">
					<button type="button" class="executor btn btn-success">Execute
						the Query</button>
					<div class="panel-body">
						<div id="executed"></div>
					</div>
				</div>
				<div id="#response"></div>
				<div id="sig"></div>
			</div>
		</div>
	</div>
</body>
<script>
	var editor = CodeMirror.fromTextArea(document.getElementById('query'), {
		mode : 'application/js',
		lineNumbers : true
	});
</script>
</html>
